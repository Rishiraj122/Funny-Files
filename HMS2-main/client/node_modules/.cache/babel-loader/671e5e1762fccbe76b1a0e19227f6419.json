{"ast":null,"code":"var _jsxFileName = \"/Users/sherlock/Desktop/Actual Project/HMS2-main/client/src/components/MyBill.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport jwt from \"jsonwebtoken\";\nimport GooglePayButton from '@google-pay/button-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction loadScript(src) {\n  return new Promise(resolve => {\n    const script = document.createElement(\"script\");\n    script.src = src;\n\n    script.onload = () => {\n      resolve(true);\n    };\n\n    script.onerror = () => {\n      resolve(false);\n    };\n\n    document.body.appendChild(script);\n  });\n}\n\nconst MyBill = () => {\n  _s();\n\n  const history = useHistory();\n  const [messbill, setMessbill] = useState('');\n  const [hostelbill, setHostelbill] = useState('');\n  const [roll, setRoll] = useState('');\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      const user = jwt.decode(token);\n\n      if (!user) {\n        localStorage.removeItem('token');\n        history.replace('/login');\n      }\n\n      getBill();\n    } else {\n      history.push('/login');\n    }\n  });\n\n  const goBack = () => {\n    window.location.href = \"/studentdashboard\";\n  };\n\n  const payBill = () => {};\n\n  const getBill = () => {\n    const token = localStorage.getItem('token');\n    const user = jwt.decode(token);\n    fetch('http://localhost:1337/api/mybill').then(response => response.json()).then(json => {\n      for (let i = 0; i < json.user.length; i = i + 1) {\n        if (user.roll == json.user[i].roll) {\n          console.log(user.roll);\n          setRoll(user.roll);\n          setHostelbill(json.user[i].hostelbill);\n          setMessbill(json.user[i].messbill);\n        }\n      }\n    });\n  }; //Changes Made From Here\n\n\n  async function showRazorpay() {\n    const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n\n    if (!res) {\n      alert(\"Razorpay SDK failed to load. Are you online?\");\n      return;\n    }\n\n    const data = await fetch(\"http://localhost:1337/api/razorpay\", {\n      method: \"POST\"\n    }).then(t => t.json());\n    console.log(data);\n    const options = {\n      key: \"rzp_test_0tpemkHKm5K1Bc\",\n      currency: data.currency,\n      amount: data.amount.toString(),\n      order_id: data.id,\n      name: \"Donation\",\n      description: \"Thank you for nothing. Please give us some money\",\n      image: \"http://localhost:1337/logo.svg\",\n      handler: function (response) {\n        // alert(response.razorpay_payment_id);\n        // alert(response.razorpay_order_id);\n        // alert(response.razorpay_signature);\n        alert(\"Transaction successful\");\n      },\n      prefill: {\n        name: \"Rajat\",\n        email: \"rajat@rajat.com\",\n        phone_number: \"9899999999\"\n      }\n    };\n    const paymentObject = new window.Razorpay(options);\n    paymentObject.open();\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"My Bill\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"My Roll: \", roll]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Mess Bill: \", messbill]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Hostel Bill: \", hostelbill]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: goBack,\n      children: \"Go Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: payBill,\n      children: \"Pay Bill\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Razorpay payment portal ezzzz\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: showRazorpay,\n      children: \"Razor Pay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MyBill, \"wGtaFRYkirAynDZYirzL57wmqFQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = MyBill;\nexport default MyBill;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyBill\");","map":{"version":3,"sources":["/Users/sherlock/Desktop/Actual Project/HMS2-main/client/src/components/MyBill.js"],"names":["React","useEffect","useState","useHistory","jwt","GooglePayButton","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","MyBill","history","messbill","setMessbill","hostelbill","setHostelbill","roll","setRoll","token","localStorage","getItem","user","decode","removeItem","replace","getBill","push","goBack","window","location","href","payBill","fetch","then","response","json","i","length","console","log","showRazorpay","res","alert","data","method","t","options","key","currency","amount","toString","order_id","id","name","description","image","handler","prefill","email","phone_number","paymentObject","Razorpay","open"],"mappings":"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","sourcesContent":["import React,{useEffect, useState} from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport jwt from \"jsonwebtoken\";\nimport GooglePayButton from '@google-pay/button-react';\n\n\nfunction loadScript(src) {\n    return new Promise((resolve) => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n      script.onload = () => {\n        resolve(true);\n      };\n      script.onerror = () => {\n        resolve(false);\n      };\n      document.body.appendChild(script);\n    });\n  }\n  \n\n\nconst MyBill=()=>{\n    const history=useHistory();\n    const [messbill, setMessbill]=useState('');\n    const [hostelbill, setHostelbill]=useState('');\n    const [roll, setRoll]=useState('');\n\n    useEffect(()=>{\n        const token=localStorage.getItem('token');\n        if(token){\n            const user = jwt.decode(token)\n            if(!user){\n                localStorage.removeItem('token');\n                history.replace('/login')\n            }\n            getBill();\n        }\n        else{\n            history.push('/login')\n        }\n    })\n\n    const goBack=()=>{\n        window.location.href=\"/studentdashboard\"\n    }\n\n    const payBill=()=>{\n\n    }\n\n    const getBill=()=>{\n        const token = localStorage.getItem('token');\n        const user = jwt.decode(token)\n        fetch('http://localhost:1337/api/mybill',)\n        .then((response)=>response.json())\n        .then((json)=>{\n            for(let i=0;i<json.user.length;i=i+1){\n                if(user.roll==json.user[i].roll){\n                    console.log(user.roll);\n                    setRoll(user.roll);\n                    setHostelbill(json.user[i].hostelbill);\n                    setMessbill(json.user[i].messbill);\n                }\n            }\n\n        })\n    }\n\n\n    //Changes Made From Here\n\n    async function showRazorpay() {\n        const res = await loadScript(\n          \"https://checkout.razorpay.com/v1/checkout.js\"\n        );\n    \n        if (!res) {\n          alert(\"Razorpay SDK failed to load. Are you online?\");\n          return;\n        }\n    \n        const data = await fetch(\"http://localhost:1337/api/razorpay\", {\n          method: \"POST\",\n        }).then((t) => t.json());\n    \n        console.log(data);\n    \n        const options = {\n          key: \"rzp_test_0tpemkHKm5K1Bc\",\n          currency: data.currency,\n          amount: data.amount.toString(),\n          order_id: data.id,\n          name: \"Donation\",\n          description: \"Thank you for nothing. Please give us some money\",\n          image: \"http://localhost:1337/logo.svg\",\n          handler: function (response) {\n            // alert(response.razorpay_payment_id);\n            // alert(response.razorpay_order_id);\n            // alert(response.razorpay_signature);\n    \n            alert(\"Transaction successful\");\n          },\n          prefill: {\n            name: \"Rajat\",\n            email: \"rajat@rajat.com\",\n            phone_number: \"9899999999\",\n          },\n        };\n        const paymentObject = new window.Razorpay(options);\n        paymentObject.open();\n      }\n\n\n\n    return(\n        <div>\n            <h1>My Bill</h1>\n            <p>My Roll: {roll}</p>\n            <p>Mess Bill: {messbill}</p>\n            <p>Hostel Bill: {hostelbill}</p>\n            <button onClick={goBack}>Go Back</button>\n            <button onClick={payBill}>Pay Bill</button>\n\n            <div></div>\n            \n            <p>Razorpay payment portal ezzzz</p>\n        <button onClick={showRazorpay}>Razor Pay</button>\n\n        </div>\n    )\n} \nexport default MyBill;"]},"metadata":{},"sourceType":"module"}